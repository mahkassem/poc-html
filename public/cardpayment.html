<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>DhamenPay</title>
		<!-- Load jQuery before the payment widget -->
		<script
			src="https://code.jquery.com/jquery-3.6.0.min.js"
			integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
			crossorigin="anonymous"
		></script>

		<script src="/proxy/widget/dhamen-pay.js" type="text/javascript"></script>
		<meta name="viewport" content="width=device-width, initial-scale=1" />

		<!-- <style type="text/css">
			body {
				font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
					"Helvetica Neue", Arial, sans-serif;
				background: #000;
			}
			.wpwl-form-card {
				box-shadow: none !important;
				background: #faf9f936 !important;
				color: #ffffff55;
				border-radius: 15px !important;
				border: none !important;
				padding: 16px !important ;
				margin: auto !important;
			}
			input[type="tel"],
			input[type="text"],
			input[type="email"],
			input[type="password"],
			select,
			textarea {
				background: transparent !important;
				border: 1px solid #ffffff55 !important;
				border-radius: 24px !important;
				color: #ffffff !important;
				font-size: 19px !important;
				padding: 24px !important;
				width: 100% !important;
				box-sizing: border-box !important;
			}
			.wpwl-control-brand {
				display: none !important;
			}
			.wpwl-label {
				display: none !important;
			}

			/* Target specific form groups for styling */
			.wpwl-group-cardNumber,
			.wpwl-group-cvv,
			.wpwl-group-expiry,
			.wpwl-group-cardHolder {
				margin-bottom: 15px !important;
			}

			/* Ensure iframes are properly sized and accessible */
			.wpwl-group-cardNumber .wpwl-control-iframe,
			.wpwl-group-cvv .wpwl-control-iframe,
			.wpwl-group-expiry .wpwl-control-iframe,
			.wpwl-group-cardHolder .wpwl-control-iframe {
				border: 1px solid #ffffff55 !important;
				border-radius: 24px !important;
				background: transparent !important;
				height: 50px !important;
				width: 100% !important;
				padding: 15px !important;
				pointer-events: auto !important;
			}

			/* Target iframe container - allow interaction */
			.wpwl-control-iframe {
				border-radius: 24px !important;
				height: auto !important;
				min-height: 40px !important;
			}

			.wpwl-button-pay {
				border: none !important;
				font-weight: bold !important;
				text-transform: uppercase !important;
				padding: 17px;
				width: 100%;
				border-radius: 50px;
			}

			/* Hide labels */
			.wpwl-label {
				display: none !important;
			}
			/* Hide brand detection */
			.wpwl-control-brand {
				display: none !important;
			}
		</style> -->
		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
					Oxygen, Ubuntu, Cantarell, sans-serif;
				background: #1a1a1a;
				display: flex;
				align-items: center;
				justify-content: center;
				min-height: 100vh;
				padding: 20px;
			}

			.container {
				width: 100%;
				max-width: 400px;
			}

			.card-details {
				background: #2a2a2a;
				border-radius: 16px;
				padding: 16px;
				margin-bottom: 20px;
				box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
			}

			.unified-input {
				display: flex;
				background: #3a3a3a;
				border: 1px solid #4a4a4a;
				border-radius: 12px;
				transition: border-color 0.2s ease;
				margin-bottom: 16px;
			}

			.unified-input:focus-within {
				border-color: #666;
			}

			input[type="text"] {
				background: transparent;
				border: none;
				padding: 16px 6px;
				color: #ffffff;
				font-size: 16px;
				outline: none;
			}

			input[type="text"]:focus {
				outline: none;
				border-color: #666;
			}

			input[type="text"]::placeholder {
				color: #888;
			}

			#cc-number {
				flex: 1 auto;
				padding-left: 44px;
			}

			#cc-exp {
				width: 70px;
				text-align: center;
				/* border-left: 1px solid #4a4a4a; */
			}

			#cc-cvc {
				width: 60px;
				text-align: center;
				padding-right: 12px;
				/* border-left: 1px solid #4a4a4a; */
			}

			#cc-holder {
				flex: 1;
				padding-left: 12px;
			}

			.payment-methods {
				color: #888;
				font-size: 14px;
				margin-bottom: 20px;
				display: flex;
				align-items: center;
				gap: 8px;
			}

			.payment-methods svg {
				height: 20px;
				width: 32px;
				margin-left: 8px;
				border-radius: 4px;
				box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
			}

			.pay-button {
				width: 100%;
				background: #4ade80;
				color: #ffffff;
				border: none;
				border-radius: 50px;
				padding: 18px;
				font-size: 18px;
				font-weight: 600;
				cursor: pointer;
				transition: background-color 0.2s ease;
			}

			.pay-button:hover {
				background: #22c55e;
			}

			.pay-button:active {
				transform: translateY(1px);
			}

			.card-icon {
				position: absolute;
				left: 12px;
				top: 50%;
				transform: translateY(-50%);
				width: 20px;
				height: 20px;
				opacity: 0.2;
			}

			.unified-input {
				position: relative;
			}
		</style>
	</head>
	<body>
		<dhamen-pay
			formstyle="card"
			invoiceid="394c2d34d18451e88e1b5f870e63be871be983944c55fae6615cabc726ea8a9f"
		></dhamen-pay>
	</body>

	<script type="text/javascript">
		// You can add custom JavaScript here if needed

		var wpwlOptions = {
			onReady: function () {
				// var mainContainer = $("<div></div>");
				// // Create a horizontal container (flexbox for layout)
				// var container = $(
				// 	'<div class="wpwl-group" style="display: flex; justify-content: center; align-items: center; margin-bottom: 10px; flex-wrap: wrap;"></div>'
				// );

				// // Add a "We Accept" label before the logos
				// var label = $(
				// 	'<span style="margin-right: 10px; font-weight: bold;">WE ACCEPT</span>'
				// );
				// container.append(label);

				// // Define available brands (from data-brands or checkout config)
				// var availableBrands = ["VISA", "MASTER", "MADA"];
				// // Add SVGs for each brand
				// availableBrands.forEach(function (brand) {
				// 	var svg = getBrandSvg(brand); // Function to get SVG markup
				// 	if (svg) {
				// 		// Wrap SVG in a div for consistent styling
				// 		var svgWrapper = $(
				// 			'<div style="height: 20px; margin: 0 10px 5px 0; cursor: pointer;" class=""></div>'
				// 		);
				// 		svgWrapper.append(svg);
				// 		container.append(svgWrapper);
				// 	}
				// });

				// // Insert the container before the pay button
				// container.insertBefore(".wpwl-button-pay");

				// Create unified container
				var unifiedContainer = $(`
<div class="container">
      <form action="submit_form.php" method="POST">
        <div class="card-details">
          <div class="unified-input">
            <svg
              class="card-icon"
              viewBox="0 0 24 24"
              fill="none"
              stroke="white"
              stroke-width="2"
            >
              <rect x="1" y="4" width="22" height="16" rx="2" ry="2" />
              <line x1="1" y1="10" x2="23" y2="10" />
            </svg>
            <input
              type="text"
              id="cc-number"
              name="card.number"
              placeholder="Card number"
              required
            />
            <input
              type="text"
              id="cc-exp"
              name="card.exp"
              placeholder="MM/YY"
              required
            />
            <input
              type="text"
              id="cc-cvc"
              name="card.cvc"
              placeholder="CVV"
              required
            />
          </div>
          <div class="unified-input">
            <input
              type="text"
              id="cc-holder"
              name="card.holder"
							class="card-holder"
              placeholder="Cardholder name"
              required
            />
          </div>

          <div class="payment-methods">
            WE ACCEPT
            <!-- MasterCard SVG -->
            <svg width="32" height="20" viewBox="0 0 32 20" fill="none">
              <rect width="32" height="20" rx="4" fill="white" />
              <circle cx="12" cy="10" r="6" fill="#EB001B" />
              <circle cx="20" cy="10" r="6" fill="#FF5F00" />
            </svg>
            <!-- Visa SVG -->
            <svg
                width="32"
                height="20"
                viewBox="0 0 780 500"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
            >
                <rect width="780" height="500" rx="40" fill="#0E4595" />
                <path
                    d="m293.2 348.73l33.361-195.76h53.36l-33.385 195.76h-53.336zm246.11-191.54c-10.57-3.966-27.137-8.222-47.822-8.222-52.725 0-89.865 26.55-90.18 64.603-0.299 28.13 26.514 43.822 46.752 53.186 20.771 9.595 27.752 15.714 27.654 24.283-0.131 13.121-16.586 19.116-31.922 19.116-21.357 0-32.703-2.967-50.227-10.276l-6.876-3.11-7.489 43.823c12.463 5.464 35.51 10.198 59.438 10.443 56.09 0 92.5-26.246 92.916-66.882 0.199-22.269-14.016-39.216-44.801-53.188-18.65-9.055-30.072-15.099-29.951-24.268 0-8.137 9.668-16.839 30.557-16.839 17.449-0.27 30.09 3.535 39.938 7.5l4.781 2.26 7.232-42.429m137.31-4.223h-41.232c-12.773 0-22.332 3.487-27.941 16.234l-79.244 179.4h56.031s9.16-24.123 11.232-29.418c6.125 0 60.555 0.084 68.338 0.084 1.596 6.853 6.49 29.334 6.49 29.334h49.514l-43.188-195.64zm-65.418 126.41c4.412-11.279 21.26-54.723 21.26-54.723-0.316 0.522 4.379-11.334 7.074-18.684l3.605 16.879s10.219 46.729 12.354 56.528h-44.293zm-363.3-126.41l-52.24 133.5-5.567-27.13c-9.725-31.273-40.025-65.155-73.898-82.118l47.766 171.2 56.456-0.064 84.004-195.39h-56.521"
                    fill="#ffffff"
                />
                <path
                    d="m146.92 152.96h-86.041l-0.681 4.073c66.938 16.204 111.23 55.363 129.62 102.41l-18.71-89.96c-3.23-12.395-12.597-16.094-24.186-16.527"
                    fill="#F2AE14"
                />
            </svg>
            <!-- Mada SVG -->
            <svg width="32" height="20" viewBox="0 0 32 20" fill="none">
              <rect width="32" height="20" rx="4" fill="#4A90E2" />
              <rect x="0" y="8.67" width="32" height="2.67" fill="white" />
              <rect x="0" y="11.33" width="32" height="8.67" fill="#8BC34A" />
            </svg>
          </div>
        </div>
      </form>
    </div>
 `);

				// Hide original fields
				// $(
				// 	[
				// 		".wpwl-group-cardNumber",
				// 		".wpwl-group-expiry",
				// 		".wpwl-group-cvv",
				// 		".wpwl-group-cardHolder",
				// 		".wpwl-group-brand",
				// 	].join(",")
				// ).hide();

				setTimeout(() => {
					// Insert into form
					$(".wpwl-button-pay").addClass("pay-button");
					// Fill in the card details
					$("iframe[name='card.number']")
						.contents()
						.find("input")
						.val("4970110000000062");
					$(".wpwl-control-expiry").val("05 / 28");
					$(".wpwl-control-cardHolder").val("Mostafa Adly");
					$("iframe[name='card.cvv']").contents().find("input").val("123");
					console.log($("iframe[name='card.cvv']"));
				}, 3000);

				// Submit the form
				// $(".wpwl-form-card").submit();
				// $(".wpwl-button-pay").removeClass("wpwl-button-pay");
				// $(".wpwl-button-pay").html("PAY");
				// $(".wpwl-form-card").prepend(unifiedContainer);
				$(".wpwl-form-card").css({
					padding: "0",
					"background-image": "none",
					"background-color": "transparent",
					border: "none",
					"box-shadow": "none",
					"border-radius": "0",
					"margin-bottom": "0",
					"margin-top": "0",
					"margin-left": "0",
				});
			},
		};

		// Helper function to return SVG markup for each brand
		function getBrandSvg(brand) {
			switch (brand.toUpperCase()) {
				case "MASTER":
				case "MASTERCARD":
					return `
<svg width="32" height="20" viewBox="0 0 32 20" fill="none">
<rect width="32" height="20" rx="4" fill="white" />
<circle cx="12" cy="10" r="6" fill="#EB001B" />
<circle cx="20" cy="10" r="6" fill="#FF5F00" />
</svg>`;
				case "VISA":
					return `
<svg width="32" height="20" viewBox="0 0 780 500" xmlns="http://www.w3.org/2000/svg" fill="none">
<rect width="780" height="500" rx="40" fill="#0E4595" />
<path d="m293.2 348.73l33.361-195.76h53.36l-33.385 195.76h-53.336zm246.11-191.54c-10.57-3.966-27.137-8.222-47.822-8.222-52.725 0-89.865 26.55-90.18 64.603-0.299 28.13 26.514 43.822 46.752 53.186 20.771 9.595 27.752 15.714 27.654 24.283-0.131 13.121-16.586 19.116-31.922 19.116-21.357 0-32.703-2.967-50.227-10.276l-6.876-3.11-7.489 43.823c12.463 5.464 35.51 10.198 59.438 10.443 56.09 0 92.5-26.246 92.916-66.882 0.199-22.269-14.016-39.216-44.801-53.188-18.65-9.055-30.072-15.099-29.951-24.268 0-8.137 9.668-16.839 30.557-16.839 17.449-0.27 30.09 3.535 39.938 7.5l4.781 2.26 7.232-42.429m137.31-4.223h-41.232c-12.773 0-22.332 3.487-27.941 16.234l-79.244 179.4h56.031s9.16-24.123 11.232-29.418c6.125 0 60.555 0.084 68.338 0.084 1.596 6.853 6.49 29.334 6.49 29.334h49.514l-43.188-195.64zm-65.418 126.41c4.412-11.279 21.26-54.723 21.26-54.723-0.316 0.522 4.379-11.334 7.074-18.684l3.605 16.879s10.219 46.729 12.354 56.528h-44.293zm-363.3-126.41l-52.24 133.5-5.567-27.13c-9.725-31.273-40.025-65.155-73.898-82.118l47.766 171.2 56.456-0.064 84.004-195.39h-56.521" fill="#ffffff" />
<path d="m146.92 152.96h-86.041l-0.681 4.073c66.938 16.204 111.23 55.363 129.62 102.41l-18.71-89.96c-3.23-12.395-12.597-16.094-24.186-16.527" fill="#F2AE14" />
</svg>`;
				case "MADA":
					return `
<svg width="32" height="20" viewBox="0 0 32 20" fill="none">
<rect width="32" height="20" rx="4" fill="#4A90E2" />
<rect x="0" y="8.67" width="32" height="2.67" fill="white" />
<rect x="0" y="11.33" width="32" height="8.67" fill="#8BC34A" />
</svg>`;
				default:
					return null; // Return null for unsupported brands
			}
		}
	</script>

	<script>
		// Get invoice ID from query string
		const urlParams = new URLSearchParams(window.location.search);
		const invoiceId = urlParams.get("invoiceId");

		// If invoice ID is provided in query string, update the dhamen-pay element
		if (invoiceId) {
			const dhamenPayElement = document.getElementById("dhamenPayWidget");
			if (dhamenPayElement) {
				dhamenPayElement.setAttribute("invoiceid", invoiceId);
			}
		} else {
			// If no invoice ID in query string, redirect back to payment selection
			console.warn(
				"No invoice ID provided. Redirecting to payment selection page."
			);
			window.location.href = "payment-select.html";
		}
	</script>
</html>
