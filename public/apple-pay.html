<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Apple Pay - HyperPay</title>
		<style>
			* {
				box-sizing: border-box;
				margin: 0;
				padding: 0;
			}

			body {
				background: #1a1a1a;
				display: flex;
				align-items: center;
				justify-content: center;
				min-height: 100vh;
				padding: 20px;
				margin: 0;
				font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
					Oxygen, Ubuntu, Cantarell, sans-serif;
			}

			/* Target all possible wrapper elements */
			dhamen-pay,
			.wpwl-wrapper,
			.wpwl-wrapper-applePay,
			.wpwl-form,
			.wpwl-form-applePay,
			.wpwl-container,
			[class*="wpwl-container"],
			[class*="wpwl-wrapper"],
			[class*="wpwl-form"],
			.dhamen-pay-container {
				width: 100% !important;
				max-width: 400px !important;
				margin: 0 auto !important;
				padding: 0 20px !important;
				display: block !important;
			}

			.wpwl-button,
			.wpwl-button-applePay,
			.wpwl-button.wpwl-button-brand,
			[class*="wpwl-button"],
			.dhamen-pay-button,
			button[class*="apple"],
			button[class*="Apple"] {
				width: 100% !important;
				min-width: 100% !important;
				max-width: 100% !important;
				background: #000000 !important;
				color: #ffffff !important;
				border: none !important;
				border-radius: 50px !important;
				font-size: 18px !important;
				font-weight: 600 !important;
				font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
					Oxygen, Ubuntu, Cantarell, sans-serif !important;
				cursor: pointer !important;
				transition: background-color 0.2s ease !important;
				padding: 30px 24px !important;
				min-height: 85px !important;
				line-height: 1.4 !important;
				display: block !important;
				margin: 0 auto !important;
				text-align: center !important;
				box-sizing: border-box !important;
			}

			.wpwl-button:hover,
			.wpwl-button-applePay:hover,
			.wpwl-button.wpwl-button-brand:hover,
			[class*="wpwl-button"]:hover,
			.dhamen-pay-button:hover {
				background: #000000 !important;
			}

			.wpwl-button:active,
			.wpwl-button-applePay:active,
			.wpwl-button.wpwl-button-brand:active,
			[class*="wpwl-button"]:active,
			.dhamen-pay-button:active {
				transform: translateY(1px) !important;
			}

			.wpwl-button img,
			.wpwl-button svg,
			.wpwl-button-applePay img,
			.wpwl-button-applePay svg,
			.wpwl-button.wpwl-button-brand img,
			.wpwl-button.wpwl-button-brand svg,
			[class*="wpwl-button"] img,
			[class*="wpwl-button"] svg,
			.dhamen-pay-button img,
			.dhamen-pay-button svg {
				vertical-align: middle !important;
				margin-left: 10px !important;
				fill: #ffffff !important;
				width: 64px !important;
				height: 64px !important;
			}

			iframe[name="cnpIframe"],
			iframe {
				width: 100% !important;
				max-width: 100% !important;
			}

			.apple-pay-fallback {
				display: none;
				color: #ffffff;
				text-align: center;
				font-size: 16px;
				padding: 20px;
			}

			@media (max-width: 767px) {
				dhamen-pay,
				.wpwl-wrapper,
				.wpwl-wrapper-applePay,
				.wpwl-form,
				.wpwl-form-applePay,
				.wpwl-container,
				[class*="wpwl-container"],
				[class*="wpwl-wrapper"],
				[class*="wpwl-form"],
				.dhamen-pay-container {
					width: 100vw !important;
					max-width: 100vw !important;
					margin: 0 !important;
					padding: 0 !important;
					display: block !important;
				}
			}

			@media (max-width: 600px) {
				body {
					padding: 20px !important;
					margin: 0 !important;
					display: flex !important;
				}

				dhamen-pay,
				.wpwl-wrapper,
				.wpwl-wrapper-applePay,
				.wpwl-form,
				.wpwl-form-applePay,
				.wpwl-container,
				[class*="wpwl-container"],
				[class*="wpwl-wrapper"],
				[class*="wpwl-form"],
				.dhamen-pay-container {
					width: 100% !important;
					max-width: 100% !important;
					padding: 0 15px !important;
					margin: 0 auto !important;
					display: block !important;
				}

				.wpwl-button,
				.wpwl-button-applePay,
				.wpwl-button.wpwl-button-brand,
				[class*="wpwl-button"],
				.dhamen-pay-button,
				button[class*="apple"],
				button[class*="Apple"] {
					width: 100% !important;
					min-width: 100% !important;
					max-width: 100% !important;
					font-size: 18px !important;
					padding: 30px 24px !important;
					min-height: 85px !important;
					line-height: 1.4 !important;
					margin: 0 !important;
					display: block !important;
					text-align: center !important;
					border-radius: 50px !important;
					box-sizing: border-box !important;
				}

				iframe[name="cnpIframe"],
				iframe {
					width: 100% !important;
					max-width: 100% !important;
				}
			}
		</style>
	</head>

	<body>
		<div class="apple-pay-fallback">
			Apple Pay is only available on Safari (iOS 10+ or macOS 10.12+). Please
			use a compatible device.
		</div>
		<script
			src="https://code.jquery.com/jquery-3.6.0.min.js"
			type="text/javascript"
		></script>
		<script>
			if (typeof jQuery === "undefined") {
				document.write(
					'<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"><\/script>'
				);
			}
		</script>
		<script src="/proxy/widget/dhamen-pay.js" type="text/javascript"></script>
		<script>
			var wpwlOptions = {
				style: "card",
				applePay: {
					buttonStyle: "black",
					buttonType: "buy",
					buttonSource: "css",
					displayName: "Dhamen Demo Store",
					merchantIdentifier: "your.merchant.id",
					checkAvailability: "canMakePayments",
					total: {
						label: "Dhamen Demo Store",
						amount: "10.00",
						type: "final",
					},
					currencyCode: "SAR",
					countryCode: "SA",
				},
				onReady: function () {
					var applePayButton = $(
						'.wpwl-button-applePay, .wpwl-button.wpwl-button-brand, [class*="wpwl-button"]'
					).not(".wpwl-button-card");
					var containers = $(
						'dhamen-pay, .wpwl-wrapper, .wpwl-wrapper-applePay, .wpwl-form, .wpwl-form-applePay, .wpwl-container, [class*="wpwl-container"], [class*="wpwl-wrapper"], [class*="wpwl-form"]'
					);

					var isMobile = $(window).width() <= 600;
					var targetWidth = isMobile ? "100vw" : "100%";

					containers.each(function () {
						$(this).css({
							width: isMobile ? "100%" : targetWidth,
							"max-width": isMobile ? "100%" : "400px",
							margin: "0 auto",
							padding: isMobile ? "0 15px" : "0 20px",
							display: "block",
							"box-sizing": "border-box",
						});
					});

					if (applePayButton.length > 0) {
						var buttonStyles = {
							width: "100%",
							"min-width": "100%",
							"max-width": "100%",
							margin: "0",
							padding: "30px 24px",
							"min-height": "85px",
							"line-height": "1.4",
							display: "block",
							"text-align": "center",
							"border-radius": "50px",
							"box-sizing": "border-box",
							background: "#000000",
							color: "#ffffff",
							border: "none",
							"font-size": "18px",
							"font-weight": "600",
							position: "relative",
							left: "0",
							right: "0",
						};

						applePayButton.css(buttonStyles);

						applePayButton.parent().css({
							width: "100%",
							"max-width": "100%",
							margin: "0",
							padding: "0",
							display: "block",
						});
					}

					if (
						applePayButton.length > 0 &&
						!applePayButton.first().find("svg").length
					) {
						applePayButton.first().append(`
            <svg fill="#ffffff" width="64px" height="64px" viewBox="0 -34.55 120.3 120.3" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff">
              <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
              <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
              <g id="SVGRepo_iconCarrier">
                <path d="M22.8 6.6c1.4-1.8 2.4-4.2 2.1-6.6-2.1.1-4.6 1.4-6.1 3.1-1.3 1.5-2.5 4-2.2 6.3 2.4.3 4.7-1 6.2-2.8M24.9 10c-3.4-.2-6.3 1.9-7.9 1.9-1.6 0-4.1-1.8-6.8-1.8-3.5.1-6.7 2-8.5 5.2-3.6 6.3-1 15.6 2.6 20.7 1.7 2.5 3.8 5.3 6.5 5.2 2.6-.1 3.6-1.7 6.7-1.7s4 1.7 6.8 1.6 4.6-2.5 6.3-5.1c2-2.9 2.8-5.7 2.8-5.8-.1-.1-5.5-2.1-5.5-8.3-.1-5.2 4.2-7.7 4.4-7.8-2.3-3.6-6.1-4-7.4-4.1"></path>
                <g>
                  <path d="M54.3 2.9c7.4 0 12.5 5.1 12.5 12.4 0 7.4-5.2 12.5-12.7 12.5H46v12.9h-5.9V2.9h14.2zm-8.3 20h6.7c5.1 0 8-2.8 8-7.5 0-4.8-2.9-7.5-8-7.5h-6.8v15h.1zM68.3 33c0-4.8 3.7-7.8 10.3-8.2l7.6-.4v-2.1c0-3.1-2.1-4.9-5.5-4.9-3.3 0-5.3 1.6-5.8 4h-5.4c.3-5 4.6-8.7 11.4-8.7 6.7 0 11 3.5 11 9.1v19h-5.4v-4.5h-.1c-1.6 3.1-5.1 5-8.7 5-5.6 0-9.4-3.4-9.4-8.3zm17.9-2.5v-2.2l-6.8.4c-3.4.2-5.3 1.7-5.3 4.1 0 2.4 2 4 5 4 4 0 7.1-2.7 7.1-6.3zM96.9 51v-4.6c.4.1 1.4.1 1.8.1 2.6 0 4-1.1 4.9-3.9 0-.1.5-1.7.5-1.7l-10-27.6h6.1l7 22.5h.1l7-22.5h6L110 42.4c-2.4 6.7-5.1 8.8-10.8 8.8-.4-.1-1.8-.1-2.3-.2z"></path>
                </g>
              </g>
            </svg>
          `);
					}
				},
			};
		</script>
		<dhamen-pay
			id="dhamenPayWidget"
			invoiceid="e3430b89e601d93e19c07c163e8255efd7943bbaad38ecd8f5f3201ce90d1170"
			paymentBrand="APPLEPAY"
		></dhamen-pay>

		<script>
			// Get invoice ID from query string
			const urlParams = new URLSearchParams(window.location.search);
			const invoiceId = urlParams.get("invoiceId");

			// If invoice ID is provided in query string, update the dhamen-pay element
			if (invoiceId) {
				const dhamenPayElement = document.getElementById("dhamenPayWidget");
				if (dhamenPayElement) {
					dhamenPayElement.setAttribute("invoiceid", invoiceId);
				}
			} else {
				// If no invoice ID in query string, redirect back to payment selection
				console.warn(
					"No invoice ID provided. Redirecting to payment selection page."
				);
				window.location.href = "payment-select.html";
			}
		</script>
	</body>
</html>
